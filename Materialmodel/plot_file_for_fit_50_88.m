close all

lambda1 = [1.000:.01:1.3];






        C1 = 0.6029 ; C2 =  0;% for corrected
Pvslambda =  lambda1.^(-3).*(0.169803E3+(-0.1E1).*lambda1.^2+(-0.131042E2).*(4+ ...
  (-0.197768E1).*lambda1.^2+0.582345E-2.*lambda1.^4).^(1/2)).^(-2).* ...
  (0.228959E3+0.1E1.*lambda1.^4+(-0.74171E3).*(4+(-0.197768E1).* ...
  lambda1.^2+0.582345E-2.*lambda1.^4).^(1/2)+lambda1.^2.*(( ...
  -0.226404E3)+0.131042E2.*(4+(-0.197768E1).*lambda1.^2+ ...
  0.582345E-2.*lambda1.^4).^(1/2))).^(-1).*(C1.*((-0.179211E7)+( ...
  -0.342919E2).*lambda1.^10+0.58055E7.*(4+(-0.197768E1).*lambda1.^2+ ...
  0.582345E-2.*lambda1.^4).^(1/2)+lambda1.^4.*(0.344122E7+( ...
  -0.658995E7).*(4+(-0.197768E1).*lambda1.^2+0.582345E-2.* ...
  lambda1.^4).^(1/2))+lambda1.^2.*(0.132908E7+(-0.683793E5).*(4+( ...
  -0.197768E1).*lambda1.^2+0.582345E-2.*lambda1.^4).^(1/2))+ ...
  lambda1.^8.*(0.174686E5+(-0.449367E3).*(4+(-0.197768E1).* ...
  lambda1.^2+0.582345E-2.*lambda1.^4).^(1/2))+lambda1.^6.*(( ...
  -0.199778E7)+0.152608E6.*(4+(-0.197768E1).*lambda1.^2+ ...
  0.582345E-2.*lambda1.^4).^(1/2)))+C2.*((-0.40536E7)+0.925926E0.* ...
  lambda1.^12+0.672219E7.*(4+(-0.197768E1).*lambda1.^2+0.582345E-2.* ...
  lambda1.^4).^(1/2)+lambda1.^4.*(0.73566E7+(-0.799004E7).*(4+( ...
  -0.197768E1).*lambda1.^2+0.582345E-2.*lambda1.^4).^(1/2))+ ...
  lambda1.^2.*(0.202805E7+(-0.154668E6).*(4+(-0.197768E1).* ...
  lambda1.^2+0.582345E-2.*lambda1.^4).^(1/2))+lambda1.^8.*( ...
  0.940764E5+(-0.515076E4).*(4+(-0.197768E1).*lambda1.^2+ ...
  0.582345E-2.*lambda1.^4).^(1/2))+lambda1.^10.*((-0.550287E3)+ ...
  0.121335E2.*(4+(-0.197768E1).*lambda1.^2+0.582345E-2.*lambda1.^4) ...
  .^(1/2))+lambda1.^6.*((-0.414468E7)+0.528936E6.*(4+(-0.197768E1).* ...
  lambda1.^2+0.582345E-2.*lambda1.^4).^(1/2))));
plot(Pvslambda*145.08,lambda1,'r','linewidth',2)
hold on
 Material_fit = [Pvslambda'*145.08 lambda1'];
 save('Material_fit_5088.mat','Material_fit');




P_exp = [0:2:18];
lambda1_exp =  [  1 1.0220 1.0330 1.0549 1.0769 1.1099 1.1209 1.1538 ...
                    1.1978 1.2418];
plot(P_exp,lambda1_exp,'ro:','linewidth',2)
h = legend('Corrected angles (45,87)','Experimental');
h.FontSize = 14;
h.FontWeight = 'bold';
xlim([0 max(P_exp)])
grid on
title ('Mooney Rivlin fit (50,88)','Fontweight','bold','fontsize',12)

set(gca,'linewidth',1.5,'FontSize',16,'fontweight','bold')
xlabel('Pressure (in psi)','fontweight','bold','fontsize',20)
ylabel('\lambda_1','fontweight','bold','fontsize',20)
