%% PLotting pressure vs diamters
close all
pressure_55 = 12:24;
Rcyl_55 = [0.5500   12.0000    0.0282    0.5227         0
    0.5500   13.0000    0.0248    0.4439         0
    0.5500   14.0000    0.0220    0.3825         0
    0.5500   15.0000    0.0193    0.3278         0
    0.5500   16.0000    0.0169    0.2833         0
    0.5500   17.0000    0.0153    0.2533         0
    0.5500   18.0000    0.0138    0.2262         0
    0.5500   19.0000    0.0121    0.1978         0
    0.5500   20.0000    0.0110    0.1798         0
    0.5500   21.0000    0.0099    0.1618         0
    0.5500   22.0000    0.0088    0.1438         0
    0.5500   23.0000    0.0080    0.1317         0
    0.5500   24.0000    0.0070    0.1167         0
];

pressure_40 = 14:24;
Rcyl_40 = [ 0.4000   14.0000    0.0212    0.3537         0
    0.4000   15.0000    0.0176    0.2897         0
    0.4000   16.0000    0.0165    0.2692         0
    0.4000   17.0000    0.0164    0.2647         0
    0.4000   18.0000    0.0147    0.2346         0
    0.4000   19.0000    0.0115    0.1834         0
    0.4000   20.0000    0.0102    0.1632         0
    0.4000   21.0000    0.0108    0.1722         0
    0.4000   22.0000    0.0090    0.1448         0
    0.4000   23.0000    0.0072    0.1170         0

    0.4000   24.0000    0.0079    0.1281         0];

pressure_45 = 13:24;
Rcyl_45 = [0.4500   13.0000    0.0243    0.4225         0
    0.4500   14.0000    0.0209    0.3552         0
    0.4500   15.0000    0.0192    0.3207         0
    0.4500   16.0000    0.0179    0.2939         0
    0.4500   17.0000    0.0155    0.2524         0
    0.4500   18.0000    0.0130    0.2103         0
    0.4500   19.0000    0.0121    0.1954         0
    0.4500   20.0000    0.0116    0.1862         0
    0.4500   21.0000    0.0096    0.1549         0
    0.4500   22.0000    0.0087    0.1410         0
    0.4500   23.0000    0.0083    0.1351         0
    0.4500   24.0000    0.0067    0.1103         0];

pressure_50 = 13:24;
Rcyl_50 = [0.5000   13.0000    0.0244    0.4303         0
    0.5000   14.0000    0.0218    0.3755         0
    0.5000   15.0000    0.0197    0.3315         0
    0.5000   16.0000    0.0172    0.2843         0
    0.5000   17.0000    0.0149    0.2445         0
    0.5000   18.0000    0.0137    0.2233         0
    0.5000   19.0000    0.0125    0.2031         0
    0.5000   20.0000    0.0108    0.1744         0
    0.5000   21.0000    0.0099    0.1606         0
    0.5000   22.0000    0.0090    0.1463         0
    0.5000   23.0000    0.0078    0.1272         0
    0.5000   24.0000    0.0072    0.1192         0];


figure 
% plot(pressure_35, Rcyl_35(:,3),'r',pressure_40, Rcyl_40(:,3),'g',...
%     pressure_45, Rcyl_45(:,3),'b',pressure_50, Rcyl_50(:,3),'c', 'linewidth',2)
plot(pressure_40, Rcyl_40(:,3),'r',...
    pressure_45, Rcyl_45(:,3),'g',pressure_50, Rcyl_50(:,3),'b',...
    pressure_55, Rcyl_55(:,3),'c','linewidth',2.5)

xlabel('Pressure(in psi)','fontweight','bold','fontsize',20)
ylabel('Cylinder radius (in m)','fontweight','bold','fontsize',20)
grid on
legend('40 cm', '45 cm', '50 cm','55 cm')
set(gca,'linewidth',1.5,'FontSize',16)
xlim([13 24])
title('Pressure vs Cylinder radius for 60, 88 actuator','fontsize',20)

%%  Vol frac vs selsction measure plots
params_5588 = [       0         0    1.0000         0
    0.0100    0.9923    1.0002    1.4690
    0.0200    1.9830    1.0005    2.9560
    0.0300    2.9722    1.0007    4.4610
    0.0400    3.9597    1.0010    5.9842
    0.0500    4.9455    1.0012    7.5258
    0.0600    5.9297    1.0015    9.0859
    0.0700    6.9121    1.0017   10.6646
    0.0800    7.8928    1.0020   12.2621
    0.0900    8.8718    1.0022   13.8789
    0.1000    9.8490    1.0025   15.5147
    0.1100   10.8244    1.0028   17.1699
    0.1200   11.7980    1.0030   18.8446
    0.1300   12.7697    1.0033   20.5391
    0.1400   13.7395    1.0036   22.2535
    0.1500   14.7074    1.0039   23.9881
    0.1600   15.6734    1.0041   25.7431
    0.1700   16.6374    1.0044   27.5187
    0.1800   17.5994    1.0047   29.3151
    0.1900   18.5594    1.0050   31.1325
    0.2000   19.5173    1.0053   32.9712
    0.2100   20.4731    1.0056   34.8315
    0.2200   21.4268    1.0059   36.7138
    0.2300   22.3784    1.0062   38.6181
    0.2400   23.3277    1.0065   40.5447
    0.2500   24.2749    1.0069   42.4941
    0.2600   25.2197    1.0072   44.4664
    0.2700   26.1623    1.0075   46.4620
    0.2800   27.1026    1.0078   48.4812
    0.2900   28.0404    1.0082   50.5247
    0.3000   28.9759    1.0085   52.5923
];

params_6088 = [ 0         0    1.0000         0
    0.0100    1.0007    1.0002    1.2330
    0.0200    2.0000    1.0004    2.4797
    0.0300    2.9981    1.0006    3.7403
    0.0400    3.9949    1.0008    5.0148
    0.0500    4.9904    1.0010    6.3032
    0.0600    5.9845    1.0012    7.6057
    0.0700    6.9773    1.0014    8.9222
    0.0800    7.9687    1.0016   10.2529
    0.0900    8.9587    1.0018   11.5977
    0.1000    9.9473    1.0021   12.9570
    0.1100   10.9345    1.0023   14.3305
    0.1200   11.9203    1.0025   15.7185
    0.1300   12.9046    1.0027   17.1210
    0.1400   13.8874    1.0029   18.5380
    0.1500   14.8688    1.0032   19.9698
    0.1600   15.8486    1.0034   21.4163
    0.1700   16.8269    1.0036   22.8776
    0.1800   17.8037    1.0039   24.3538
    0.1900   18.7789    1.0041   25.8451
    0.2000   19.7525    1.0044   27.3515
    0.2100   20.7246    1.0046   28.8730
    0.2200   21.6950    1.0048   30.4099
    0.2300   22.6638    1.0051   31.9621
    0.2400   23.6309    1.0053   33.5298
    0.2500   24.5964    1.0056   35.1131
    0.2600   25.5601    1.0059   36.7121
    0.2700   26.5222    1.0061   38.3268
    0.2800   27.4825    1.0064   39.9579
    0.2900   28.4410    1.0066   41.6047
    0.3000   29.3978    1.0069   43.2677
];

params_6588= [         0         0    1.0000         0
    0.0100    1.0083    1.0002    1.0166
    0.0200    2.0156    1.0003    2.0438
    0.0300    3.0219    1.0005    3.0817
    0.0400    4.0271    1.0006    4.1303
    0.0500    5.0313    1.0008    5.1895
    0.0600    6.0344    1.0010    6.2594
    0.0700    7.0365    1.0011    7.3402
    0.0800    8.0375    1.0013    8.4316
    0.0900    9.0374    1.0015    9.5338
    0.1000   10.0362    1.0017   10.6468
    0.1100   11.0339    1.0018   11.7706
    0.1200   12.0304    1.0020   12.9054
    0.1300   13.0258    1.0022   14.0510
    0.1400   14.0201    1.0024   15.2074
    0.1500   15.0132    1.0026   16.3748
    0.1600   16.0052    1.0027   17.5532
    0.1700   16.9959    1.0029   18.7425
    0.1800   17.9855    1.0031   19.9428
    0.1900   18.9738    1.0033   21.1541
    0.2000   19.9610    1.0035   22.3765
    0.2100   20.9469    1.0037   23.6100
    0.2200   21.9315    1.0039   24.8546
    0.2300   22.9150    1.0041   26.1104
    0.2400   23.8971    1.0043   27.3773
    0.2500   24.8780    1.0045   28.6555
    0.2600   25.8576    1.0047   29.9448
    0.2700   26.8358    1.0049   31.2455
    0.2800   27.8128    1.0051   32.5575
    0.2900   28.7884    1.0053   33.8808
    0.3000   29.7627    1.0055   35.2154
];

params_7088 = [        0         0    1.0000         0
    0.0100    1.0155    1.0001    0.8145
    0.0200    2.0301    1.0003    1.6371
    0.0300    3.0440    1.0004    2.4679
    0.0400    4.0571    1.0005    3.3068
    0.0500    5.0694    1.0006    4.1539
    0.0600    6.0808    1.0008    5.0091
    0.0700    7.0914    1.0009    5.8725
    0.0800    8.1013    1.0010    6.7440
    0.0900    9.1102    1.0012    7.6237
    0.1000   10.1183    1.0013    8.5116
    0.1100   11.1256    1.0014    9.4076
    0.1200   12.1320    1.0016   10.3118
    0.1300   13.1375    1.0017   11.2241
    0.1400   14.1422    1.0019   12.1445
    0.1500   15.1459    1.0020   13.0734
    0.1600   16.1488    1.0021   14.0103
    0.1700   17.1508    1.0023   14.9554
    0.1800   18.1518    1.0024   15.9086
    0.1900   19.1520    1.0026   16.8701
    0.2000   20.1512    1.0027   17.8397
    0.2100   21.1495    1.0029   18.8176
    0.2200   22.1468    1.0030   19.8036
    0.2300   23.1432    1.0032   20.7979
    0.2400   24.1386    1.0034   21.8003
    0.2500   25.1331    1.0035   22.8110
    0.2600   26.1266    1.0037   23.8299
    0.2700   27.1191    1.0038   24.8570
    0.2800   28.1106    1.0040   25.8924
    0.2900   29.1012    1.0041   26.9360
    0.3000   30.0907    1.0043   27.9878
];

params_7588 = [        0         0    1.0000         0
    0.0100    1.0222    1.0001    0.6224
    0.0200    2.0439    1.0002    1.2509
    0.0300    3.0650    1.0003    1.8854
    0.0400    4.0855    1.0004    2.5260
    0.0500    5.1054    1.0005    3.1727
    0.0600    6.1247    1.0006    3.8254
    0.0700    7.1434    1.0007    4.4841
    0.0800    8.1615    1.0008    5.1489
    0.0900    9.1790    1.0009    5.8196
    0.1000   10.1959    1.0010    6.4965
    0.1100   11.2121    1.0011    7.1794
    0.1200   12.2277    1.0012    7.8683
    0.1300   13.2427    1.0013    8.5632
    0.1400   14.2571    1.0014    9.2641
    0.1500   15.2707    1.0015    9.9710
    0.1600   16.2838    1.0016   10.6839
    0.1700   17.2962    1.0017   11.4028
    0.1800   18.3079    1.0018   12.1276
    0.1900   19.3189    1.0019   12.8588
    0.2000   20.3293    1.0020   13.5958
    0.2100   21.3390    1.0021   14.3387
    0.2200   22.3480    1.0022   15.0876
    0.2300   23.3563    1.0024   15.8425
    0.2400   24.3639    1.0025   16.6033
    0.2500   25.3709    1.0026   17.3702
    0.2600   26.3771    1.0027   18.1430
    0.2700   27.3826    1.0028   18.9218
    0.2800   28.3874    1.0029   19.7065
    0.2900   29.3914    1.0031   20.4972
    0.3000   30.3948    1.0032   21.2938
];


bh = boxplot([params_5588(2:end,4)./params_5588(2:end,2),...
    params_6088(2:end,4)./params_6088(2:end,2),...
    params_6588(2:end,4)./params_6588(2:end,2),...
    params_7088(2:end,4)./params_7088(2:end,2),...
    params_7588(2:end,4)./params_7588(2:end,2)],...
    'Labels',{'55 deg','60 deg','65 deg', '70 deg', '75 deg'},'Widths',.8);
set(bh(:,:),'linewidth',3)
title('Selection measure when \alpha = 88 deg and varying \beta',...
    'fontweight','bold','fontsize',20)
set(gca,'linewidth',1.5,'FontSize',16,'fontweight','bold')
xlabel('\beta (in degrees)','fontweight','bold','fontsize',20)
ylabel('Torsion/Curvature','fontweight','bold','fontsize',20)

%% prototypes vol frac versus selection measure

params_5885 = [         0         0    1.0000         0
    0.0100    0.9375    1.0005    1.3435
    0.0200    1.8721    1.0010    2.6983
    0.0300    2.8037    1.0015    4.0644
    0.0400    3.7323    1.0020    5.4417
    0.0500    4.6579    1.0025    6.8302
    0.0600    5.5805    1.0030    8.2299
    0.0700    6.5000    1.0036    9.6407
    0.0800    7.4164    1.0041   11.0625
    0.0900    8.3298    1.0046   12.4953
    0.1000    9.2399    1.0052   13.9392
    0.1100   10.1470    1.0057   15.3939
    0.1200   11.0509    1.0063   16.8595
    0.1300   11.9516    1.0068   18.3360
    0.1400   12.8490    1.0074   19.8233
    0.1500   13.7433    1.0079   21.3213
    0.1600   14.6343    1.0085   22.8300
    0.1700   15.5220    1.0091   24.3495
    0.1800   16.4064    1.0097   25.8795
    0.1900   17.2875    1.0103   27.4202
    0.2000   18.1653    1.0108   28.9714
    0.2100   19.0397    1.0114   30.5331
    0.2200   19.9107    1.0120   32.1053
    0.2300   20.7784    1.0126   33.6880
    0.2400   21.6426    1.0133   35.2811
    0.2500   22.5033    1.0139   36.8845
    0.2600   23.3606    1.0145   38.4982
    0.2700   24.2145    1.0151   40.1223
    0.2800   25.0648    1.0157   41.7566
    0.2900   25.9116    1.0164   43.4011
    0.3000   26.7549    1.0170   45.0557];

params_4687 = [         0         0    1.0000         0
    0.0100    0.9443    1.0005    1.9389
    0.0200    1.8854    1.0009    3.9038
    0.0300    2.8232    1.0014    5.8949
    0.0400    3.7576    1.0019    7.9128
    0.0500    4.6886    1.0024    9.9576
    0.0600    5.6161    1.0029   12.0299
    0.0700    6.5401    1.0034   14.1302
    0.0800    7.4605    1.0039   16.2587
    0.0900    8.3771    1.0044   18.4161
    0.1000    9.2901    1.0050   20.6028
    0.1100   10.1992    1.0055   22.8194
    0.1200   11.1044    1.0060   25.0663
    0.1300   12.0057    1.0066   27.3442
    0.1400   12.9029    1.0072   29.6536
    0.1500   13.7959    1.0077   31.9954
    0.1600   14.6848    1.0083   34.3701
    0.1700   15.5693    1.0089   36.7783
    0.1800   16.4494    1.0095   39.2210
    0.1900   17.3250    1.0101   41.6989
    0.2000   18.1959    1.0107   44.2128
    0.2100   19.0622    1.0113   46.7637
    0.2200   19.9236    1.0120   49.3526
    0.2300   20.7801    1.0126   51.9804
    0.2400   21.6315    1.0133   54.6484
    0.2500   22.4776    1.0140   57.3575
    0.2600   23.3184    1.0147   60.1092
    0.2700   24.1537    1.0154   62.9048
    0.2800   24.9834    1.0161   65.7456
    0.2900   25.8072    1.0168   68.6333
    0.3000   26.6250    1.0175   71.5695];

params_6687 = [         0         0    1.0000         0
    0.0100    0.9945    1.0002    0.9953
    0.0200    1.9877    1.0005    2.0001
    0.0300    2.9794    1.0007    3.0145
    0.0400    3.9697    1.0009    4.0384
    0.0500    4.9586    1.0011    5.0718
    0.0600    5.9461    1.0014    6.1148
    0.0700    6.9321    1.0016    7.1672
    0.0800    7.9166    1.0019    8.2292
    0.0900    8.8997    1.0021    9.3006
    0.1000    9.8812    1.0023   10.3815
    0.1100   10.8613    1.0026   11.4719
    0.1200   11.8398    1.0028   12.5716
    0.1300   12.8168    1.0031   13.6811
    0.1400   13.7922    1.0033   14.7999
    0.1500   14.7661    1.0036   15.9281
    0.1600   15.7384    1.0039   17.0658
    0.1700   16.7092    1.0041   18.2129
    0.1800   17.6783    1.0044   19.3694
    0.1900   18.6458    1.0047   20.5354
    0.2000   19.6118    1.0049   21.7107
    0.2100   20.5760    1.0052   22.8955
    0.2200   21.5386    1.0055   24.0897
    0.2300   22.4996    1.0057   25.2932
    0.2400   23.4589    1.0060   26.5062
    0.2500   24.4165    1.0063   27.7285
    0.2600   25.3724    1.0066   28.9603
    0.2700   26.3266    1.0069   30.2014
    0.2800   27.2790    1.0072   31.4518
    0.2900   28.2297    1.0074   32.7116
    0.3000   29.1787    1.0077   33.9808];


bh = boxplot([params_4687(2:end,4)./params_4687(2:end,2),...
    params_5885(2:end,4)./params_5885(2:end,2),...
    params_6687(2:end,4)./params_6687(2:end,2)],...
    'Labels',{'85,  58',' 87,  46',...
    ' 87,  66'},'Widths',.8);
set(bh(:,:),'linewidth',3)
title('Selection measure with volume prototypes',...
    'fontweight','bold','fontsize',20)
set(gca,'linewidth',1.5,'FontSize',16,'fontweight','bold')
xlabel('\beta (in degrees)','fontweight','bold','fontsize',20)
ylabel('Torsion/Curvature','fontweight','bold','fontsize',20)

%% Pressure vs selection measure plots
figure

L = 1;
load Material_fit_5088.mat
alpha = 86.88*pi/180;
beta = 45.49*pi/180;
Ro = 13/64*.0254;
lambda_5088 = Material_fit(:,2);
lambda1 = lambda_5088;
delta_5088 =  -L.*Ro.^(-1).*cos(alpha).^3.*cos(beta).^3.*csc(alpha+(-1).*beta) ...
  .^2.*csc(alpha+beta).*(((-1).*lambda1.^2+sec(beta).^2).*tan(alpha) ...
  .^2+sec(alpha).^4.*sec(beta).^4.*(cos(alpha).^6.*((-1)+ ...
  lambda1.^2.*cos(alpha).^2).*cos(beta).^6.*((-1)+lambda1.^2.*cos( ...
  beta).^2).*(tan(alpha)+(-1).*tan(beta)).^4).^(1/2)+(2.*lambda1.^2+ ...
  (-1).*sec(alpha).^2+(-1).*sec(beta).^2).*tan(alpha).*tan(beta)+(( ...
  -1).*lambda1.^2+sec(alpha).^2).*tan(beta).^2);
delta_normal_5088 = delta_5088/L;

alpha = 85*pi/180;
beta = 58*pi/180;
load Material_fit_6088.mat
lambda_6088 = Material_fit(:,2);
lambda1 = lambda_6088;
delta_6088 = -L.*Ro.^(-1).*cos(alpha).^3.*cos(beta).^3.*csc(alpha+(-1).*beta) ...
  .^2.*csc(alpha+beta).*(((-1).*lambda1.^2+sec(beta).^2).*tan(alpha) ...
  .^2+sec(alpha).^4.*sec(beta).^4.*(cos(alpha).^6.*((-1)+ ...
  lambda1.^2.*cos(alpha).^2).*cos(beta).^6.*((-1)+lambda1.^2.*cos( ...
  beta).^2).*(tan(alpha)+(-1).*tan(beta)).^4).^(1/2)+(2.*lambda1.^2+ ...
  (-1).*sec(alpha).^2+(-1).*sec(beta).^2).*tan(alpha).*tan(beta)+(( ...
  -1).*lambda1.^2+sec(alpha).^2).*tan(beta).^2);
delta_normal_6088 = delta_6088/L;

alpha = 86*pi/180;
beta = 65.8*pi/180;
load Material_fit_7088.mat
lambda_7088 = Material_fit(:,2);
lambda1 = lambda_7088;
delta_7088 = -L.*Ro.^(-1).*cos(alpha).^3.*cos(beta).^3.*csc(alpha+(-1).*beta) ...
  .^2.*csc(alpha+beta).*(((-1).*lambda1.^2+sec(beta).^2).*tan(alpha) ...
  .^2+sec(alpha).^4.*sec(beta).^4.*(cos(alpha).^6.*((-1)+ ...
  lambda1.^2.*cos(alpha).^2).*cos(beta).^6.*((-1)+lambda1.^2.*cos( ...
  beta).^2).*(tan(alpha)+(-1).*tan(beta)).^4).^(1/2)+(2.*lambda1.^2+ ...
  (-1).*sec(alpha).^2+(-1).*sec(beta).^2).*tan(alpha).*tan(beta)+(( ...
  -1).*lambda1.^2+sec(alpha).^2).*tan(beta).^2);
delta_normal_7088 = delta_7088/L;

bh = boxplot([delta_normal_5088./((lambda_5088-1)./(2*Ro)),...
    delta_normal_6088(1:31)./((lambda_6088(1:31)-1)./(2*Ro)),...
    delta_normal_7088(1:31)./((lambda_7088(1:31)-1)./(2*Ro))],...
    'Labels',{'85,  58',' 87,  46',...
    ' 87,  66'},'Widths',.8),...
set(bh(:,:),'linewidth',3);
title('Selection measure with pressure (prototypes)',...
    'fontweight','bold','fontsize',20)
set(gca,'linewidth',1.5,'FontSize',16,'fontweight','bold')
xlabel('\beta (in degrees)','fontweight','bold','fontsize',20)
ylabel('Torsion/Curvature','fontweight','bold','fontsize',20)